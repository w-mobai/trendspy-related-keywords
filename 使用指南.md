# Google Trends 监控工具 - 使用指南

## ✅ 已完成的配置

1. ✅ Python 虚拟环境已创建 (venv)
2. ✅ 所有依赖包已安装
3. ✅ Google Trends API 测试通过
4. ✅ 配置文件已创建

## 🚀 快速开始

### 方式 1：查看数据（不需要任何通知配置）

直接运行快速测试，数据会显示在终端：

```bash
source venv/bin/activate
python quick_test.py
```

### 方式 2：运行完整监控（数据保存到本地）

```bash
source venv/bin/activate
python trends_monitor.py --test
```

这会：
- 查询所有配置的关键词
- 将数据保存到 `data_YYYYMMDD` 目录
- 生成 CSV 报告和 JSON 数据文件

### 方式 3：定时任务模式

```bash
source venv/bin/activate
python trends_monitor.py
```

程序会在每天 23:05 自动运行查询。

## ⚙️ 配置说明

### 1. 修改监控的关键词

编辑 `config.py` 文件中的 KEYWORDS 列表：

```python
KEYWORDS = [
    "Image",
    "Video", 
    "Music",
    "Voice",
    "Text",
    # 添加你想监控的关键词
]
```

### 2. 修改查询时间范围

在 `config.py` 中修改：

```python
TRENDS_CONFIG = {
    'timeframe': 'now 7-d',  # 最近7天
    # 其他选项: 'now 1-d', 'now 30-d', 'now 90-d', 'today 12-m'
    'geo': '',  # 全球，或者 'US', 'CN' 等
}
```

### 3. 修改定时任务时间

在 `config.py` 中修改：

```python
SCHEDULE_CONFIG = {
    'hour': 23,      # 23点
    'minute': 5,     # 5分
}
```

## 📧 配置邮件通知（可选）

如果想接收邮件通知：

1. 编辑 `.env` 文件：

```bash
TRENDS_SMTP_SERVER=smtp.gmail.com
TRENDS_SMTP_PORT=587
TRENDS_SENDER_EMAIL=你的邮箱@gmail.com
TRENDS_SENDER_PASSWORD=应用专用密码
TRENDS_RECIPIENT_EMAIL=接收邮箱@example.com
```

2. Gmail 应用专用密码设置：
   - 登录 Google 账号
   - 进入"安全性"设置
   - 开启"两步验证"
   - 生成"应用专用密码"

3. 修改 `config.py` 中的通知方式：

```python
NOTIFICATION_CONFIG = {
    'method': 'email',  # 使用邮件通知
}
```

## 💬 配置微信通知（可选，目前有登录问题）

微信登录目前存在超时问题，建议暂时使用邮件或本地文件方式。

如果要尝试微信通知：

1. 运行微信工具查找接收者：
```bash
source venv/bin/activate
python wechat_utils.py
```

2. 在 `.env` 中配置接收者：
```bash
TRENDS_WECHAT_RECEIVER=filehelper  # 或者群名称/好友备注名
```

3. 修改 `config.py`：
```python
NOTIFICATION_CONFIG = {
    'method': 'wechat',  # 或 'both' 同时使用邮件和微信
}
```

## 📁 数据文件说明

运行后会生成：

```
data_20260220/
├── daily_report_20260220.csv      # CSV 格式的汇总报告
├── related_queries_Image.json     # 每个关键词的详细数据
├── related_queries_Video.json
└── ...
```

## 🔧 常用命令

```bash
# 激活虚拟环境
source venv/bin/activate

# 快速测试（3个关键词）
python quick_test.py

# 测试所有关键词
python trends_monitor.py --test

# 测试指定关键词
python trends_monitor.py --test --keywords "Python" "AI"

# 运行定时任务
python trends_monitor.py

# 退出虚拟环境
deactivate
```

## ❓ 常见问题

### Q: 如何只查看数据不发送通知？

A: 在 `config.py` 中注释掉通知配置，或者直接运行 `quick_test.py`

### Q: 数据保存在哪里？

A: 在 `data_YYYYMMDD` 目录下，每天一个目录

### Q: 如何修改查询频率？

A: 编辑 `config.py` 中的 `SCHEDULE_CONFIG`

### Q: 微信登录超时怎么办？

A: 目前建议使用邮件通知或本地文件方式，微信登录问题需要进一步调试

## 📝 下一步建议

1. ✅ 先用 `quick_test.py` 测试基本功能
2. ✅ 修改 `config.py` 中的关键词列表
3. ⏭️ 配置邮件通知（如果需要）
4. ⏭️ 运行 `python trends_monitor.py --test` 测试完整流程
5. ⏭️ 设置定时任务自动运行

## 🎯 当前状态

- ✅ 环境配置完成
- ✅ Google Trends 查询正常
- ⚠️ 微信登录有问题（可选功能）
- ⏭️ 邮件通知待配置（可选功能）

你现在可以直接使用本地文件模式，数据会保存到本地，随时可以查看！
